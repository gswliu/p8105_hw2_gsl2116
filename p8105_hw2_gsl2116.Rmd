---
title: "p8105_hw2_gsl2116"
author: "Grace Liu"
date: "9/30/2018"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
```

## Problem 1
```{r clean_transit}
transit_data = read_csv(file = "./HW_Data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line, station_name, station_latitude, route1:route11, entry, entrance_type, vending, ada) %>% 
  mutate(entry = recode(entry, "YES" = TRUE, "NO" = FALSE))
```
This dataset has 1868 observations and 18 variables (dimensions = 1868 x 18). From the original 32 variables in the dataset, I have only kept 18 that are of interest in my analysis: line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance. This data set includes character, integer, logical, and numeric variable types.  

#### How many distinct stations are there?
```{r distinct_stations, eval=FALSE}
nrow(distinct(transit_data, line, station_name))
```
There are `r nrow(distinct(transit_data, line, station_name))` distinct train stations.

#### How many stations are ADA compliant?
```{r ada_stations, eval=FALSE}
nrow(distinct(filter(transit_data, ada == TRUE), line, station_name))
```
Of these `r nrow(distinct(transit_data, line, station_name))` distinct stations, `r nrow(distinct(filter(transit_data, ada == TRUE), transit_data, line, station_name))` are ADA compliant.

#### What proportion of station entrances / exits without vending allow entrance?
```{r entry_stations}
transit_data %>%
  group_by(vending, entry) %>%
  summarise (n = n()) %>%
  mutate(freq = n / sum(n))
```
Of station entrances/exits without vending, 0.377 allow entrance.

## Problem 2
```{r clean_mrtrash}
mrtrash_data =
  read_excel("./HW_Data/HealthyHarborWaterWheelTotals2018-7-28.xlsx",
             sheet = "Mr. Trash Wheel", skip = 1, col_names = TRUE, range = "A2:N256") %>% 
  janitor::clean_names() %>% 
  drop_na(dumpster) %>% 
  mutate(sports_balls = as.integer(round(sports_balls)))
```

There are a total of 215 observations and 14 variables. 
Be sure to note the number of observations in both resulting datasets, and give examples of key variables. 

In 2016, the median number of sports balls in a dumpster was `r median(mrtrash_data$sports_balls[mrtrash_data$year == 2016], na.rm = TRUE)`.

```{r join_precip}
precip_2016 =
  read_excel("./HW_Data/HealthyHarborWaterWheelTotals2018-7-28.xlsx",
             sheet = "2016 Precipitation", skip = 1, col_names = TRUE, range = "A2:B14") %>% 
  janitor::clean_names() %>% 
  mutate(year = 2016)

precip_2017 =
  read_excel("./HW_Data/HealthyHarborWaterWheelTotals2018-7-28.xlsx",
             sheet = "2017 Precipitation", skip = 1, col_names = TRUE, range = "A2:B14") %>%
  janitor::clean_names() %>% 
  drop_na(total) %>% 
  mutate(year = 2017)

precip_data =
  full_join(precip_2016, precip_2017) %>% 
  mutate(month = month.name[month])
```
Be sure to note the number of observations in both resulting datasets, and give examples of key variables. For available data, what was the total precipitation in 2017? 

## Problem 3
```{r brfss_setup, include=FALSE}
devtools::install_github("p8105/p8105.datasets") # install.packages("devtools")
library(p8105.datasets)
```

```{r clean_brfss}
brfss_data = brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(topic == "Overall Health") %>% 
  select(-class, -topic, -question, -sample_size, -confidence_limit_low:-geo_location) %>% 
  spread(key = response, value = data_value)
```

There are `r nrow(distinct(brfss_data, locationabbr))` unique locations included in the dataset. Every state, plus the District of Columbia, is represented. The state that is observed the most is `r names(which.max(table(brfss_data$locationabbr)))`. The median of the “Excellent” response value in 2002 is `r median(brfss_data$Excellent[brfss_data$year == 2002], na.rm = TRUE)`.

Make a histogram of “Excellent” response values in the year 2002.  

Make a scatterplot showing the proportion of “Excellent” response values in New York County and Queens County (both in NY State) in each year from 2002 to 2010.  